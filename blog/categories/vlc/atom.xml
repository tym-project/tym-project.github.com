<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: vlc | Tym-Project]]></title>
  <link href="http://blog.tym-project.fr/blog/categories/vlc/atom.xml" rel="self"/>
  <link href="http://blog.tym-project.fr/"/>
  <updated>2014-06-22T16:21:03+00:00</updated>
  <id>http://blog.tym-project.fr/</id>
  <author>
    <name><![CDATA[Tym]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Monitorer une application sous Linux]]></title>
    <link href="http://blog.tym-project.fr/2009/07/17/monitorer-une-application-sous-linux/"/>
    <updated>2009-07-17T14:32:33+00:00</updated>
    <id>http://blog.tym-project.fr/2009/07/17/monitorer-une-application-sous-linux</id>
    <content type="html"><![CDATA[<p>Il peut être très utile de vérifier l'état d'une application à intervalles
réguliers : mon serveur de streaming est-il opérationnel, mon tunnel ssh est-
il encore ouvert ?... Mais comment faire quand le service en question ne
propose pas de moyen "natif" de vérifier ces infos ?</p>

<!-- more -->


<p>Pour ma part j'utilise un simple script bash et <code>[man]crontab[/man]</code> pour la
planification. Dans l'exemple je vais vérifier que mon serveur de streaming
fonctionne bien, soit quand vlc n'inscrit pas "video server down" dans son log
(exemple tout à fait fictif) :
{% codeblock lang:bash %}</p>

<h1>!/bin/bash</h1>

<p>VLC_LOG="/var/log/vlc.log"
ERROR_LOG="/var/log/vlc_error.log"</p>

<p>if tail -500 $VLC_LOG | grep 'video server down'; then</p>

<pre><code>echo "$date Server down" &gt;&gt; $LOG_FILE /home/tym/vlc_server/restart
</code></pre>

<p>fi
{% endcodeblock %}</p>

<p>Ce script vérifie donc l'état du service en fonction du fichier journal. Si il
détecte une erreur il peut (par exemple) redémarrer le service. Les
possibilités sont quasi infinies (envoie de mail, connexion à un autre
serveur...), la seule limitation est la capacité du service à créer un log
suffisamment détaillé.</p>

<p>Pour le planifier, utilisez <code>[man]crontab[/man] -e</code> avec une ligne dans ce
style :</p>

<pre><code>*/1 * * * * /home/tym/scripts/check_vlc
</code></pre>

<p>Si vous voulez vérifier à un intervalle inférieur à 1 minute vous pouver
modifier le script comme suit (et ne plus utiliser cron) :
{% codeblock lang:bash %}</p>

<h1>!/bin/bash</h1>

<p>VLC_LOG="/var/log/vlc.log"
ERROR_LOG="/var/log/vlc_error.log"
while :; do</p>

<pre><code>if tail -500 $VLC_LOG | grep 'video server down'; then
    echo "$date Server down" &gt;&gt; $LOG_FILE
    /home/tym/vlc_server/restart
fi
sleep 15
</code></pre>

<p>done
{% endcodeblock %}
Bon monitoring ;-)</p>
]]></content>
  </entry>
  
</feed>
